<!doctype html>

<html>
  <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
  <script>
    $(function(){
      $.ajax({
        url: 'https://api.spotify.com/v1/me',
        headers: {
          'Authorization' : 'Bearer ' + localStorage.getItem('access_token')
        },
        success: function(response) {
          var userProfileTemplate = Handlebars.compile($('#user-profile-template').html());
          response.display_name = response.display_name.split(' ')[0];
          $('#bkgrd_dk_a').html(userProfileTemplate(response))
          $('#logout-button').click(function(){
            localStorage.clear();
            window.location = 'http://spotinfinity.azurewebsites.net/login.html';
          })
        },
        error: function() {
          localStorage.clear();
          window.location = 'http://spotinfinity.azurewebsites.net/login.html';
        }
      });
      $.ajax({
        //url: 'https://api.spotify.com/v1/audio-features/05KfyCEE6otdlT1pp2VIjP',
        url: 'https://api.spotify.com/v1/recommendations',
        headers: {
          'Authorization' : 'Bearer ' + localStorage.getItem('access_token')
        },
        success: function(response2) {
          console.log(response2)
        }
      })
    });
  </script>

  <head>
    <title>Spotinfinity</title>

    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">

    <link rel="stylesheet" href="css/style.css" type="text/css">
  </head>

  <body>
    <header id="header">
      <div id="bkgrd_dk">
        <div id="bkgrd_dk_a"> <!-- User profile -->
        </div> <!-- End of user profile -->

        <div id="bkgrd_dk_b">
          <H3>Search Presets</H3>

          <div class="btn"><p>Rock</p></div>
          <div class="btn_offset"><p>Pop</p></div>

          <div class="btn"><p>RnB</p></div>
          <div class="btn_offset"><p>Alternate</p></div>

          <div class="btn"><p>Jazz</p></div>
          <div class="btn_offset"><p>Classic</p></div>

          <div class="btn"><p>Country</p></div>
          <div class="btn_offset"><p>Dance</p></div>

          <div class="btn"><p>Electronic</p></div>
          <div class="btn_offset"><p>Indie</p></div>
        </div>

        <div id="bkgrd_dk_c">
          <div class="btn_sq"><p>Albums</p></div>
          <div class="btn_sq_offset"><p>Singles</p></div>

          <div class="btn_rctgl"><p>Artists</p></div>
          <div class="btn_rctgl"><p>Songs</p></div>
        </div>
      </div>
    </header> <!-- End #header -->

    <footer id="footer">
    </footer> <!-- End #header -->
  </body>

  <script id='user-profile-template' type='text/x-handlebars-template'>
    <h1>Hello, {{display_name}}</h1>
    <img width='100' src='{{images.0.url}}' />
    <button id='logout-button'>Log out</button>
  </script>
</html>
